<!DOCTYPE html>

<script type="text/x-template" id='v-notification-message-template'>
    <div class='width-100-per'>
        <transition name="fade">
            <div class='marketplace-promotion-sticky dark-shadow-div clickable' :class='{keepCollapsed : notification_message.keepCollapsed}' v-if='!showExpanded && !hideSticky' @click='() => { if(!notification_message.keepCollapsed) showExpanded = true; }' id='collapsed-sticky'>
                <img class="white-icon right-mar-10" :src="notification_message.icon"/>
                <span class='underline font-regular' v-html='notification_message.desktop_collapsed_message'></span>
                <img class='close-icon-x' src="/images/merchandiser/rootIndex/closeMenu_icon.svg" @click.stop='updateSessionClicks'/>
            </div>
        </transition>

        <transition name='slide'>
            <div class='notif-open dark-shadow-div' v-if='!mobileMode && showExpanded' id='desktop-expanded-sticky' @focus='' @focusout='showExpanded = false;' tabindex="0">
                <img src="/images/notificationMessages/Downwardarrow_icon.svg" alt="Downwardarrow" class='down-arrow green-icon clickable' @click='showExpanded = false'>
                <div class='flex-row pad-30 mar-bot-10 width-100-per center-along'>
                    <div class='width-70-per flex-row center-along'>
                        <div class='width-15-per flex-col flex-end-across font-regular'>
                            <div>
                                <img class='green-icon mar-bot-5' style='width: 30px;' :src="notification_message.icon" :alt='notification_message.icon'/>
                                <div class='green-text ' style='max-width: 200px; word-wrap: break-word;'>{{notification_message.title}}</div>
                            </div>
                        </div>
                        <div class='green-border-right h-mar-20'></div>
                        <div class='green-text html-content' style='word-wrap: break-word; width: 375px;' v-html='notification_message.content' @click='updateUniqueClicks'></div>
                    </div>
                </div>
            </div>
        </transition>

        <transition name='slide'>
            <div class='notif-open dark-shadow-div' v-if='mobileMode && showExpanded' style='bottom: -15' id='mobile-expanded-sticky'>
                <img src="/images/notificationMessages/Downwardarrow_icon.svg" alt="Downwardarrow" class='down-arrow green-icon clickable' @click='showExpanded = false'>
                <div class='pad-40 height-100-per' style='top: 25%'>
                    <div class='font-regular'>
                        <img class='green-icon mar-bot-5' style='width: 30px;' :src="notification_message.icon" :alt='notification_message.icon'/>
                        <div class='green-text' style='word-wrap: break-word; max-width: 90%'>{{notification_message.title}}</div>
                    </div>
                    <div class='green-text html-content mobile-html-content mar-top-20' style='word-wrap: break-word;' v-html='notification_message.content' @click='updateUniqueClicks'></div> 
                </div>
            </div>
        </transition>
    </div>
</script>

<style>
    .keepCollapsed .underline {
        text-decoration: none;
    }
</style><script type="text/x-template" id='v-input-template'>
    
<div class='v-input-class flex-col flex-end-along' :class='{"extra-large-important": onlyOneOnRow,"highlight": (curValue && (!(typeof curValue === "object" && curValue !== null && !curValue.start) || typeof curValue === "object" && Object.keys(curValue).length) && !(required && !validValue) && !(readOnly)) || focused, "validation-error": required && !validValue,"inline-label":inlineLabel,"read-only":readOnly}'>
        <div class='height-100-per pos-relative' :class='{"flex-col flex-end-along" :!inlineLabel, "flex-row center-across": inlineLabel}'>
            <div v-if='label && inlineLabel && type != "select"' class='grey-label regular-text font-light border-right d-inline width-auto pad-5 h-pad-10 input-cursor' v-on:click='focusInput()'>
                {{label}}
            </div>
            <div v-else-if='label && !inlineLabel' class='dark-grey-text big-text font-regular'>
                {{label}}
                <span v-if='required' class='red-text'>*</span>
            </div>
            <div v-if='["address","textautocomplete"].includes(type)'>
                <input 
                    type="text" 
                    :placeholder='placeholder ? placeholder : "Entrer valeur"' 
                    :autocomplete='autocomplete ? autocomplete : "off"'
                    :value='curValue'
                    
                    v-on:input='curValue = $event.target.value; $emit("input",$event.target.value); autocompleteSearchFocused = true; type === "textautocomplete" ? filterSearchResults($event.target.value) : null;'
                    @blur='blur();$emit("blur",$event);'
                    @focus='focus();$emit("focus",$event);'
                >
                <ul class='places-list' v-if='searchResults.length > 0 && autocompleteSearchFocused'>
                    <li class='places-list-item clickable' v-for="(result, i) in searchResults" :key="i" @click='onMapValueChange(result)'>
                        <div class='flex-row clickable' v-if='type == "address"'>
                            {{result}}
                        </div>
                        <div class='flex-row clickable' v-else>
                            <div class='font-regular right-mar-5'>{{ result.value }}</div>
                        </div>
                    </li>
                </ul>
            </div>
            <v-select-legacy v-else-if='type == "select"'
                v-bind="selectProps"
                :value='curValue'
                @input='curValue = $event; $emit("input",$event)'
                @search='(search, loading) => { $emit("search",[search, loading])}'
                @open='$emit("open")' 
                :autocomplete='autocomplete ? autocomplete : "off"'
                :placeholder='placeholder ? placeholder : "Choisi une option"'
            >   
                <template #search="{ attributes, events }">
                    <input
                        class="vs__search"
                        v-bind="attributes"
                        v-on="events"
                    />
                    <div v-if='label && inlineLabel' class='grey-label regular-text font-light border-right  d-inline width-auto min-width-25-per pad-5 '>
                        {{label}}
                    </div>
                </template>
                <template v-if='formattedLabel' v-slot:option="option" >
                    <div v-if="option.user_badge" class="v-pad-2">
                        <v-user-badge 
                            :user_name='option.user_badge.user_name'
                            :user_email='option.user_badge.user_email ? option.user_badge.user_email : ""'
                            :internal_employee_id='option.user_badge.internal_employee_id'
                            :user_id='option.value'
                            :badge_clr='option.user_badge.badge_clr'
                            :hide_id="hide_id"
                            >
                        </v-user-badge>
                    </div>
                    <div v-else v-html="option.formatted_label" class="v-pad-2"></div>
                </template>
                <template v-if='formattedLabel' v-slot:selected-option="option">
                    <div v-if="option.user_badge">
                        <v-user-badge 
                            :user_name='option.user_badge.user_name'
                            :internal_employee_id='option.user_badge.internal_employee_id'
                            :user_id='option.value'
                            :badge_clr='option.user_badge.badge_clr'
                            :hide_id="hide_id"
                            >
                        </v-user-badge>
                    </div>
                    <div v-else v-html="option.formatted_label"></div>
                </template>
            </v-select-legacy>
            <v-select-legacy v-else-if='type == "selectTime"'
                v-bind="selectProps"
                :value='curValue'
                :options='selectTimeOptions'
                @input='curValue = $event; $emit("input",$event)'
                :autocomplete='autocomplete ? autocomplete : "off"'
                :placeholder='placeholder ? placeholder : "Choisi une option"'
            >
                <template #search="{ attributes, events }">
                    <input
                        class="vs__search"
                        v-bind="attributes"
                        v-on="events"
                    />
                    <div v-if='label && inlineLabel' class='grey-label regular-text font-light border-right  d-inline width-auto min-width-25-per pad-5 '>
                        {{label}}
                    </div>
                </template>
                <template v-if='formattedLabel' v-slot:option="option" >
                    <div v-html="option.formatted_label" class="v-pad-2"></div>
                </template>
                <template v-if='formattedLabel || inlineLabel' v-slot:selected-option="option">
                    <div v-html="option.formatted_label"></div>
                </template>
            </v-select-legacy>
            <v-select-legacy v-else-if='type == "selectTime"'
                v-bind="selectProps"
                :value='curValue'
                :options='selectTimeOptions'
                @input='curValue = $event; $emit("input",$event)'
                :autocomplete='autocomplete ? autocomplete : "off"'
                :placeholder='placeholder ? placeholder : "Choisi une option"'
            >
            </v-select-legacy>
            <customdatepicker v-else-if='type == "date"'
                :disabled='disabled'
                :datepickerprops="dateProps"
                :value='curValue'
                :minDate='minDate'
                :maxDate='maxDate'
                :available_dates='available_dates'
                @input='curValue = $event; $emit("input",$event)'
                :highlights='false'
                opens='right'
                :show-dropdowns='true'
                :linked-calendars='false'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                :placeholder='placeholder ? placeholder : "Choisi une date"'
            >
            </customdatepicker>
            <div v-else-if='type == "date-calendar"'>
                <customdatepicker
                    :datepickerprops="dateProps"
                    :calendarMode='true'
                    :value='curValue'
                    @input='curValue = $event; $emit("input",$event)'
                    @blur='blur();$emit("blur",$event);'
                    @focus='focus();$emit("focus",$event);'
                    :placeholder='placeholder ? placeholder : "Choisi une date"'
                ></customdatepicker>
                <input v-model='curValue' readonly>
            </div>

            <!-- MULITPLE FILE UPLOAD -->
            <div v-else-if='type == "file-upload"'
                class='upload-document'
                :class="{ 'center-along' : !(typeof files_list != 'undefined' &&  files_list.length), 'validation-error-file' : fileValidationError}"
                @dragover="dragover" @dragleave="dragleave" @drop="drop"
            >
                <input
                    type='file'
                    multiple 
                    name="fields[assetsFieldHandle][]" id="assetsFieldHandle" 
                    class="opacity-0"
                    ref="multiple-file-upload" accept=".pdf,.jpg,.jpeg,.png"
                    @change='addFileToInput()'
                    @blur='blur();$emit("blur",$event);'
                    @focus='focus();$emit("focus",$event);'
                />
                <ul 
                    class="width-100-per no-mar no-pad overflow-y-auto" 
                    style='height: 180px;'
                    v-if="typeof files_list != 'undefined' &&  files_list.length" 
                    v-cloak >
                    <li class="text-sm p-1" v-for="(file_obj,file_index) in files_list">
                        <div class="flex-row space-between center-across pad-10">
                            <div class='flex-row center-across width-70-per'>
                                <div class='width-10-per right-mar-10'>
                                    <a class="no-underline" target="_blank"  :href="file_obj.url" download >
                                        <img src='/images/po/actions/Attachment_loaded.svg'/>
                                    </a>
                                </div>
                                <div class="flex-col" style="word-wrap: break-word;">
                                    <a class="no-underline" target="_blank" :href="file_obj.url" download > {{file_obj.name}}</a>
                                    <div class="light-grey-text small-text" v-if="file_obj.uploadedDate">{{getFileDate(file_obj.uploadedDate)}} - {{file_obj.size}}</div>
                                </div> 
                            </div>
                            <div class="flex-col width-20-per h-mar-10" v-if='document_type'>
                                <v-select-legacy 
                                    class="basic"
                                    v-bind = document_type                      
                                    :placeholder="'File Type'"
                                    v-model = 'file_obj.document_type_id'
                                > 
                                </v-select-legacy> 
                            </div>
                            <div class='width-10-per flex-row center-across'>
                                <a class="remove-link right-mar-10" href="javascript:void(0)" @click="removeFileFromInput(file_obj)" title="Remove file"><img src="/images/po/actions/Remove.svg" /></a>
                                <a class="no-underline" target="_blank" :href="file_obj.url" download > <img src='/images/po/actions/Download_attachment.svg'/> </a>
                            </div>
                        </div>
                    </li>
                </ul>
                <div 
                    v-else 
                    class="empty-attachment clickable"
                    style='min-height: 160px;' 
                    @click="$refs['multiple-file-upload'].click();">
                    <img src='/images/po/actions/Attachment_empty_gray.svg' class='pad-top-30'/>
                </div>
                <div class="sticky-note" @click="$refs['multiple-file-upload'].click();">
                    <span><strong>Télécharger</strong>
                    ou glisser-déposer des fichiers</span>
                </div>
            </div>

            <!-- UPLOAD AND DISPLAY PHOTO -->
            <div v-else-if='type == "upload-and-display-photo"'>
                <div @click="triggerAddPhoto()"> 
                    <img v-if="uploadAndDisplay_photo" :src="uploadAndDisplay_photo" class='photo-display'/> 
                    <div v-else class='photo-placeholder flex-col center-along center-across' :class="{'validation-error-file' : fileValidationError}">
                        <span>+  Ajouter une photo</span>
                    </div>
                </div>
                <input 
                    type="file" 
                    ref="upload-and-display-photo" 
                    accept=".jpg,.jpeg,.png" 
                    v-on:change ='uploadProfileImage($event)' 
                    style='display:none;'
                />
            </div>

            <textarea v-else-if='type == "textarea" && !charcterlength'
                :placeholder='placeholder' 
                :readOnly='readOnly'
                :maxlength='maxLength'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                v-on:keyup.enter='$emit("enter",$event)'
                :value='curValue' 
                v-on:input='curValue = $event.target.value; $emit("input",$event.target.value)'>
            </textarea>
            <div v-else-if='type == "textarea" && charcterlength'> 
                <textarea 
                    :placeholder='placeholder' 
                    :readOnly='readOnly'
                    :maxlength='maxLength' 
                    @blur='blur();$emit("blur",$event);'
                    @focus='focus();$emit("focus",$event);'
                    v-on:keyup.enter='$emit("enter",$event)'
                    :value='curValue' 
                    v-on:input='curValue = $event.target.value; $emit("input",$event.target.value);checkDescriptionLength($event,required)'>
                </textarea>
                <div class="text-right light-grey-text v-mar-15" v-if="value">{{value.length}}/{{charcterlength}}</div>
            </div>
            <input v-else-if='type == "phone"'
                type='text' 
                :placeholder='placeholder ? placeholder : "Entrer valeur"' 
                :readOnly='readOnly'
                :disabled='disabled'
                :maxlength='maxLength'
                :autocomplete='autocomplete ? autocomplete : "off"'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                v-on:keyup.enter='$emit("enter",$event)'
                :value='curValue' 
                v-on:input='handlePhoneValue'
                v-on:keydown.tab='$emit("tab",$event)'
            >
            <input v-else-if='type == "password"'
                :type='showPassword ? "text" : "password"' 
                :placeholder='placeholder ? placeholder : "Entrer valeur"' 
                :readOnly='readOnly'
                :disabled='disabled'
                :maxlength='maxLength'
                :autocomplete='autocomplete ? autocomplete : "off"'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                v-on:keyup.enter='$emit("enter",$event)'
                style='padding-right:38px;'
                :value='curValue' 
                v-on:input='curValue = $event.target.value; $emit("input",$event.target.value)'
                v-on:keydown.tab='$emit("tab",$event)'
            />
            <input v-else-if='type == "codevalidation"'
                :type='"text"' 
                :placeholder='placeholder ? placeholder : "Entrer valeur"' 
                :readOnly='readOnly'
                :disabled='disabled'
                :maxlength='maxLength'
                :autocomplete='autocomplete ? autocomplete : "off"'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                v-on:keyup.enter='$emit("enter",$event)'
                style='padding-left:38px;'
                :value='curValue' 
                v-on:input='handleCodeValidationValue'
                v-on:keydown.tab='$emit("tab",$event)'
            />
            <input v-else 
                :type='type' 
                :placeholder='placeholder ? placeholder : "Entrer valeur"' 
                :readOnly='readOnly'
                :disabled='disabled'
                :maxlength='maxLength'
                :autocomplete='autocomplete ? autocomplete : "off"'
                @blur='blur();$emit("blur",$event);'
                @focus='focus();$emit("focus",$event);'
                v-on:keyup.enter='$emit("enter",$event)'
                :value='curValue'
                v-on:input='curValue = $event.target.value; $emit("input",$event.target.value)'
                v-on:keydown.tab='$emit("tab",$event)'
                :min="type == 'number' ? number_min : undefined"
                :max="type == 'number' ? number_max : undefined"
                :step="type == 'number' ? step : undefined"
            >
            <img v-if='search && curValue' src='/images/clear_input.svg' class='input-x' v-on:click='curValue = null; $emit("input", null)'>
            <img v-if='search' src='/images/search.svg' class='input-search' v-on:click='$emit("enter",curValue)'>
            </input>
            <img v-if='type == "password" && showPassword' src='/images/subLot/view_hidden.svg' class='show-password' v-on:click='showPassword = !showPassword'>
            <img v-else-if='type == "password" && !showPassword' src='/images/subLot/view.svg' class='show-password' v-on:click='showPassword = !showPassword'>
            <img v-if='type == "codevalidation"' src='/images/mobiledevice_message.svg' class='validate-code'>
        </div>
    </div>
</script>
<script type="text/x-template" id='lufa-datepicker-template' >
    <div class="v-custom-date">
        <v-date-picker
            :value='dp_value'
            :masks='default_masks'
            :columns='(datepickerprops && datepickerprops.isRange) && (datepickerprops && !datepickerprops.singleDateRange) ? 2 : 1'
            :model-config='modelConfig'
            :min-date='minDate'
            :max-date='maxDate'
            :availableDates='available_dates'
            :step='1'
            timezone='utc'
            :locale='currentLocale'
            v-bind='datepickerprops'
            show-current="2021-11-13"
            @input='dp_value = $event; $emit("input",dp_value)'>
            <template v-slot="{ inputValue, inputEvents, showPopover }" v-if='!calendarMode'>
                <input :class='inputClass' v-if='datepickerprops && datepickerprops.isRange' :value='inputValue.start && inputValue.end ? inputValue.start+" - "+inputValue.end : ""' v-on='inputEvents.start' :placeholder='placeholder'>
                <input :class='inputClass' v-else :value='inputValue' v-on='inputEvents' :placeholder='placeholder'>
            </template>
        </v-date-picker>
    </div>

</script><script type="text/x-template" id='popup_template'>
    <div v-show='show_popup' class='popup-component overlay' v-on:click='closeIfCancelable()' :style='{ "z-index": coverSidebar ? 120 : 100 }'>
        <div class='content'   :style="maxWidth ? `max-width: ${maxWidth}px` : ''">
            <div class='box' v-on:click.stop>
                <div v-if='(cancelable || show_close_on_cancelable) && (type != "close-custom")'  class='close-popup' v-on:click='close()'><img :src='closeicongreen ? "/images/v2/Close.svg" : "/images/merchandiser/rootIndex/closeMenu_iconGrey.svg"'></img></div>
                <div v-if='type == "custom" || type == "close-custom"'>
                    <slot :name='customSlot' v-bind:close='close'></slot>
                </div>
                <div v-if='(type == "yesno" || type == "acknowledge")' class='flex-col'>
                    <h2 class='mar-bot-20'>{{ popupTitle }}</h2>
                    <div class='regular-text light-grey-text mar-bot-30' v-if='popupDescription'>{{popupDescription}}</div>
                    <div class='flex-row' v-if='type == "yesno"'>
                        <button v-on:click='confirm()' class='right-mar-10' :class='popupConfirmClass'>{{ popupConfirm }}</button>
                        <button v-on:click='reject()' :class='popupRejectClass'>{{ popupReject }}</button>
                    </div>
                    <div class='flex-row' v-else>
                        <button v-on:click='acknowledge()' :class='acknowledgeButtonClass'>{{ popupAcknowledge }}</button>
                    </div>
                </div>
                <div v-if='(type == "clientDisplay")' class='flex-col'>
                    <div class='big-text mar-bot-20'>{{ popupTitle }}</div>
                    <div class='regular-text light-grey-text mar-bot-30' v-if='popupDescription'>{{popupDescription}}</div>
                    <button type="reset" style='width: 60px; min-width: 60px; padding: 0 10px;' class='mar-auto' v-on:click='close()'>OK</button>
                </div>
                <div v-if='(type == "error" || type == "success")' class='flex-col center-across'>
                    <img v-if='type == "error"' style='width: 70px; height: 70px' class='mar-bot-20' src='/images/merchandiser/rootIndex/redX_large_Icon.svg'></img>
                    <img v-if='type == "success"' style='width: 70px; height: 70px' class='mar-bot-20' src='/images/merchandiser/rootIndex/greenCheck_large_icon.svg'></img>
                    <div class='font-regular grey-text text-center mar-bot-30'>{{message}}</div>
                    <button v-if='!autoclose' type="reset" style='width: 60px; min-width: 60px; padding: 0 10px;' v-on:click='close(); confirmEvent ? confirmEvent() : null;'>OK</button>
                </div>
                <div v-if='type == "form"' class='flex-1 flex-wrap flex-row width-100-per'>
                    <h2 class='mar-bot-20 h-mar-15'>{{ popupTitle }}</h2>
                    <div class='regular-text light-grey-text mar-bot-30 h-mar-15' v-if='popupDescription'>{{popupDescription}}</div>
                    <v-input v-for='(input,key) in formData.formInput' v-if='["text","number","textarea","select"].includes(input.type)'
                        v-bind='input'
                        v-model='formData.model[input.field]'
                        :key='key'
                    ></v-input>
                    <div class='flex-row center-along width-100-per'>
                        <button v-on:click='submitForm()'>{{formData.buttonLabel}}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</script>
<script>
    var getUrl = window.location;
    var baseUrl = getUrl.protocol + "//" + getUrl.host + "/" +
        'fr';
    var baseUrlNoLang = getUrl.protocol + "//" + getUrl.host;
    var language = 'fr';
    var translations = {};
    var app_ver = '3.649';
    var googleMapsApiKey = "AIzaSyCLGaslu0-PKIAZMtqMUJaU2mxWTGYVnKM";

    // Broadcast current login state to other tabs for Help-Chat coordination
    try {
        localStorage.setItem('helpchat_user_id', '4618');

        // If the user is NOT logged in, proactively clear any stale Help-Chat session
        const uid = localStorage.getItem('helpchat_user_id');
        if (!uid) {
            const cid = localStorage.getItem('chat_id');
            ['chat_id', 'chat_owner', 'chat_last_activity'].forEach(k => localStorage.removeItem(k));
            if (cid) {
                // Remove chat blobs (both namespaced and legacy) and dynamic per-chat keys
                localStorage.removeItem(`helpchat_${cid}`);
                localStorage.removeItem(cid);
                ['currentFunctionCallId_', 'isProductSelectorActive_', 'isPhotoUploadActive_', 'refund_cancelled_', 'help_chat_disclaimer_shown_']
                    .forEach(prefix => localStorage.removeItem(prefix + cid));
            }
        }
    } catch (e) {
        /* ignore if localStorage not available */
    }
</script>

<html xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="fr"
    lang="fr">

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="language" content="fr" />
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="google" content="notranslate">

    <!-- Klaro styles -->
    <link rel="stylesheet" href="https://cdn.kiprotect.com/klaro/v0.7.22/klaro.css" />

    <!-- Klaro JS -->
    <script defer src="https://cdn.kiprotect.com/klaro/v0.7.22/klaro.js"></script>

    <script type="text/x-template" id="help-chat-template">
    <div class="help-chat-container">
        <div class="chat-header">
            <div class="chat-title">
                <div class="chat-title-primary">{{ language === 'fr' ? 'Besoin d\'aide?' : 'How can we help?' }}</div>
                <div class="chat-title-secondary">{{ language === 'fr' ? 'Assistant virtuel' : 'Virtual assistant' }}</div>
            </div>
            <div class="chat-header-actions">
                <div class="connection-status" :class="{ 'connected': wsConnected }">
                    {{ wsConnected ? 
                        (language === 'fr' ? 'Connecté' : 'Connected') : 
                        (language === 'fr' ? 'Déconnecté' : 'Disconnected') 
                    }}
                </div>
                <button class="close-button" @click="$emit('close')">×</button>
            </div>
        </div>
        
        <div class="chat-messages" ref="chatMessages">
            <div v-for="message in messages" 
                 :key="message.id"
                 :class="['message', message.sender]">
                <div v-if="typeof message.content === 'string'" 
                     class="message-content" 
                     v-html="message.content">
                </div>
                
                <div v-else-if="message.content.type === 'product_selector'"
                     class="product-selector">
                    <h3>{{ message.content.config.title || (language === 'fr' ? 'Sélectionner les produits' : 'Select Products') }}</h3>
                    <p>{{ message.content.config.description }}</p>
                    
                    <div class="chat-product-list">
                        <div v-for="product in message.content.config.products"
                             :key="product.id"
                             class="chat-product-item"
                             :class="{
                                'refrigerated': (product.storage && product.storage.basket_mode_code > 0) || product.conservationMode > 0,
                                'gift': (Array.isArray(product.tags) ? product.tags.indexOf('gift') !== -1 : product.gift),
                                'customizable': product.isCustomizable,
                                'charge-by-weight': (product.pricing && product.pricing.charged_by_weight) || product.isChargedByWeight,
                                'disabled': product.isDisabled
                             }">
                            <div class="order-top">
                                <div class="chat-product-checkbox-group">
                                    <div v-for="unit in product.quantity" :key="unit" class="chat-product-checkbox" :style="(product.refunded_qty && unit <= product.refunded_qty) ? 'opacity: 0.5; pointer-events: none;' : ''">
                                        <input type="checkbox"
                                               :checked="product.refunded_qty && unit <= product.refunded_qty"
                                               :disabled="product.refunded_qty && unit <= product.refunded_qty"
                                               :value="{...product, unitIndex: unit}"
                                               v-model="selectedProducts">
                                    </div>
                                </div>
                                <div class="chat-product-image">
                                    <img :src="product.image_url || product.imageUrl" alt="Product image">
                                </div>
                                <div class="chat-product-details">
                                    <div class="chat-product-name">
                                        {{ product.product_name || product.name }}
                                    </div>
                                    <div class="chat-product-supplier" v-if="product.supplier || product.supplier_name">
                                        {{ product.supplier || product.supplier_name }}
                                    </div>
                                    <div class="chat-product-price" v-if="product.pricing && product.pricing.paid_total">
                                        $ <span class="price-dollars">{{ Math.floor(product.pricing.paid_total) }}</span><sup class="price-cents">{{ formatCents(product.pricing.paid_total) }}</sup>
                                        <span>
                                            /{{ product.units || (language === 'fr' ? 'unité' : 'unit') }} 
                                            <span v-if="(product.pricing.real_weight || product.declared_weight)">
                                                ({{ (product.pricing.real_weight || product.declared_weight) }}{{ product.unit_of_measure || product.unitOfMeasure || '' }})
                                            </span>
                                        </span>
                                    </div>
                                    <div class="chat-product-price" v-else-if="product.pricing && product.pricing.catalog_total">
                                        $ <span class="price-dollars">{{ Math.floor(product.pricing.catalog_total) }}</span><sup class="price-cents">{{ formatCents(product.pricing.catalog_total) }}</sup>
                                        <span>
                                            /{{ product.units || (language === 'fr' ? 'unité' : 'unit') }} 
                                            <span v-if="product.declared_weight">
                                                ({{ product.declared_weight }}{{ product.unit_of_measure || product.unitOfMeasure || '' }})
                                            </span>
                                        </span>
                                    </div>
                                    <div class="chat-product-price" v-else-if="product.price || product.paid_price_per_unit_for_default_weight || product.paid_price_for_real_weight">
                                        $ <span class="price-dollars">{{ Math.floor(product.price || product.paid_price_per_unit_for_default_weight || product.paid_price_for_real_weight) }}</span><sup class="price-cents">{{ formatCents(product.price || product.paid_price_per_unit_for_default_weight || product.paid_price_for_real_weight) }}</sup>
                                        <span>
                                            /{{ product.units || (language === 'fr' ? 'unité' : 'unit') }} 
                                            <span v-if="product.weight || product.real_weight">
                                                ({{ (product.weight || product.real_weight) }}{{ product.unitOfMeasure || '' }})
                                            </span>
                                        </span>
                                    </div>
                                    <div class="chat-product-free" v-else-if="(Array.isArray(product.tags) ? product.tags.indexOf('free') !== -1 : product.free)">
                                        {{ language === 'fr' ? 'GRATUIT' : 'FREE' }}
                                    </div>
                                    <div class="chat-product-status" v-if="(Array.isArray(product.tags) && product.tags.indexOf('auto_refund_due_to_short') !== -1) || product.show_short_message">
                                        <span class="short-message">{{ language === 'fr' ? 
                                            'Produit manquant. Sera remboursé automatiquement.' : 
                                            'Product was short. Will be reimbursed automatically.' }}</span>
                                    </div>
                                    <div class="chat-product-status" v-if="(Array.isArray(product.tags) && product.tags.indexOf('already_refunded') !== -1) || product.refunded_qty > 0">
                                        <span class="refunded-message">{{ language === 'fr' ? 
                                            'Déjà remboursé' : 
                                            'Already refunded' }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="submit-selection" 
                            @click="handleProductSelection(selectedProducts)"
                            :disabled="!selectedProducts.length || isSubmittingSelection">
                        {{ language === 'fr' ? 'Confirmer la sélection' : 'Confirm Selection' }}
                    </button>
                    <button class="cancel-selection" 
                            @click="handleCancelSelection"
                            :disabled="isSubmittingSelection">
                        {{ language === 'fr' ? 'Annuler la sélection' : 'Cancel Selection' }}
                    </button>
                </div>
                
                <div v-else-if="message.content.type === 'photo_upload'" class="photo-upload">
                    <p v-if="message.content.description" class="photo-upload-description" v-html="message.content.description"></p>
                    <div v-if="!photoPreview" class="photo-upload-select">
                        <p>{{ language === 'fr' ? 'Sélectionnez une image à envoyer' : 'Select an image to upload' }}</p>
                        <button class="submit-selection" @click="triggerPhotoSelect">{{ language === 'fr' ? 'Choisir une image' : 'Choose Image' }}</button>
                        <button class="cancel-selection" @click="cancelPhotoUpload">{{ language === 'fr' ? 'Annuler' : 'Cancel' }}</button>
                        <!-- Hidden file input lives inside the component so picker is scoped to chat -->
                        <input :ref="'chatPhotoInput_'+message.id" type="file" accept="image/*" style="display:none" @change="handleFileChosen" />
                    </div>
                    <div v-else class="photo-upload-preview">
                        <img :src="photoPreview" alt="preview" style="max-width:100%;border-radius:6px;margin-bottom:10px;" />
                        <button class="submit-selection" @click="confirmPhotoUpload" :disabled="uploadingPhoto">{{ language === 'fr' ? 'Envoyer' : 'Upload' }}</button>
                        <button class="cancel-selection" @click="cancelPhotoUpload" :disabled="uploadingPhoto">{{ language === 'fr' ? 'Annuler' : 'Cancel' }}</button>
                    </div>
                </div>
                
                <div v-else-if="message.type === 'attachment'" class="chat-attachment">
                    <img :src="message.content.url" alt="attachment" style="max-width: 200px; border-radius: 6px;" />
                </div>
                
                <div class="message-time">{{ formatTime(message.timestamp) }}</div>
            </div>
            
            <!-- Typing indicator -->
            <div v-if="isTyping" class="message bot typing-indicator">
                <div class="message-content">
                    <span class="typing-text">{{ typingMessage }}</span>
                    <div class="dot-container">
                        <span class="dot"></span>
                        <span class="dot"></span>
                        <span class="dot"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="chat-input">
            <textarea
                   ref="chatInput"
                   v-model="newMessage"
                   
                   @input="autoResizeInput"
                   :disabled="!initialConnectionComplete || !wsConnected || loading"
                   :placeholder="language === 'fr' ? 'Écrivez votre message...' : 'Type your message...'"
                   rows="1"
                   wrap="soft"></textarea>
            <button @click="sendMessage" :disabled="!initialConnectionComplete || !wsConnected || loading || !newMessage.trim()">
                {{ language === 'fr' ? 'Envoyer' : 'Send' }}
            </button>
        </div>
        
        
    </div>
</script>

    <style>
		#klaro {
            position: fixed;
			z-index: 9999999;
		}

        .cn-decline {
            background-color: gray !important;
        }
	</style>

    <!-- Google Code for Remarketing Tag -->

<script>
dataLayer = [{
    'userEmail': 'abb849cf8ca061145975ae35ae4ebefb24f9d78b68bd37fa87b5f80a2a0a6ffa'
  }];

const trackRegistration = (user_id) => {
  dataLayer.push({'event': 'completeRegistrationInfo'});
  dataLayer.push({'event': 'sign_up_step_1', 'user_id': user_id, 'subscription_state': "inactive"});
}

const trackDeliveryInfo = (user_id) => {
  dataLayer.push({'event': 'completeDeliveryInfo'});
  dataLayer.push({'event': 'sign_up_step_2', 'user_id': user_id, 'subscription_state': "inactive"});
}

const trackTrialSignupSuccess = (user_id) => {
  dataLayer.push({'event': 'trialSuccess', user_id: user_id, 'subscription_state': 'trial_active'});
}

// Land on signup page
const trackSignupLanding = () => {
  dataLayer.push({'event': 'signup_landing', user_id: 0, 'subscription_state': 'guest'});
}

// Land on thankyou page
const trackSignupSuccess = () => {
  dataLayer.push({'event': 'signup_success', user_id: 4618, 'subscription_state': 'active'});
}

const trackTrialBannerClick = () => {
  dataLayer.push({'event': 'free_trial_banner_click', user_id: 0, 'subscription_state': 'guest'});
}

const trackCanceledBasket = () => {
  dataLayer.push({'event': 'canceled_basket_success', user_id: 4618, 'subscription_state': 'active'});
}

const trackCancelAccountStart = () => {
  dataLayer.push({'event': 'cancel_account_start', user_id: 4618, 'subscription_state': 'active'});
}

const trackCancelAccountSuccess = () => {
  dataLayer.push({'event': 'cancel_account_success', user_id: 4618, 'subscription_state': 'inactive'});
}

</script>
<!-- Google Tag Manager bloqué par Klaro -->
<script type="text/plain" data-type="application/javascript" data-name="gtm">
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NVDH8D4');
</script>
<!-- End Google Tag Manager -->

<!-- on page load -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  //  Track user_id and subscription_state for each page views
          dataLayer.push({
        'event': 'track_page_view_data', 
        'user_id': 4618, 
        'subscription_state': "active"});
    });
</script>
<link rel="stylesheet" type="text/css" href="/assets/a0925cf7/jquery-ui.min.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/hide-recaptcha-badge.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/vhover.css" />
<link rel="stylesheet" type="text/css" href="/themes/client/css/font/stylesheet.css" />
<link rel="stylesheet" type="text/css" href="/themes/client/css/common.css" />
<link rel="stylesheet" type="text/css" href="/themes/client/css/header.css" />
<link rel="stylesheet" type="text/css" href="/themes/client/css/footer.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/notification_messages.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/input.css" />
<link rel="stylesheet" type="text/css" href="/css/vueselect.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/datepicker_component.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/employee_popup.css" />
<link rel="stylesheet" type="text/css" href="/css/v2/vuecomponents/help_chat.css" />
<script type="text/javascript" src="/assets/3623227a/jquery.min.js"></script>
<script type="text/javascript" src="/assets/3623227a/jquery-migrate.min.js"></script>
<script type="text/javascript" src="/assets/a0925cf7/jquery-ui.min.js"></script>
<script type="text/javascript" src="https://www.google.com/recaptcha/enterprise.js?render=6LcrDPcdAAAAAAT6GvKr8aldKcFPtYkCaTbOKD30"></script>
<script type="text/javascript" src="/js/vue/vue.min.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/vhover.js"></script>
<script type="text/javascript" src="/js/vue/vuerouter.js"></script>
<script type="text/javascript" src="/js/vue/vue-meta.js"></script>
<script type="text/javascript" src="/js/setup-klaro.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/global/notfound.js?v="></script>
<script type="text/javascript" src="/js/v2/vuecomponents/global/noaccess.js?v="></script>
<script type="text/javascript" src="/themes/client/js/common.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/notification_messages.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/input.js"></script>
<script type="text/javascript" src="/js/vue/vueselect.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/v-calendar@2.3.4/lib/v-calendar.umd.min.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/component_datepicker.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/employee_popup.js"></script>
<script type="text/javascript" src="/js/v2/vuecomponents/help_chat.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
window.helpChatSocketBaseUrl = "wss://montreal.lufa.com/cs_agent";
/*]]>*/
</script>
</head>

<body>
    <!-- HEADER -->
    <div id="page-wrapper" style='display: none' :class='{ "disable-click" : prevent }' :style='{zoom: scale, "min-height": (100/scale)+"vh"}'>
        <div id='page-header' v-if='!mobileMode'>
    <a id='header-lufa-icon' href='/fr'>
        <img src='/images/logo_en.png'>
    </a>
    <div id='header-top'>
                    <a href='/logout'>Déconnexion</a>
                <a href='/lufa-faq'>aide</a>
        <a :href='"/en/orders/trackOrder#"+$route.path'>EN</a>
    </div>
    <div id='header-bottom'>
                    <button onclick='window.open("/orders/gifts", "_self")' class='flex-row center-across space-around'><img width=25 height=25 src='/images/v2/header/giftsCTA_icon.svg'></img>Gifts</button>
                                    <a id='settings-icon' href='/account'>
                <img height=35 width=35 src='/images/v2/header/settings_icon.svg'>
            </a>
                <a href="/blog">Blogue</a>
        <a href="/lufa-farms-home-delivery-and-pick-up-points-near-me">Livraison</a>
        <a href="/marche">Marché</a>
        <a href="/about">À propos</a>
            </div>
</div>
<div id='header-mobile' v-else>
    <a id='header-lufa-icon' href='/fr'>
        <img src='/images/logo_en.png'>
    </a>
    <div id='header-top'>
        <div id='menu-button' v-on:click='showHeaderMenu = true' class='green-bg small-radius' style='width: 38px; height: 35px;'></div>
                            <a id='settings-icon' href='/account'>
                <img height=35 width=35 src='/images/v2/header/settings_icon.svg'>
            </a>
            </div>
    <transition name='slide-in-right'>
        <div id='header-menu' v-if='showHeaderMenu'>
            <div id='header-menu-top'>
                <a :href='"/en/orders/trackOrder#"+$route.path'>EN</a>
                <a href='/lufa-faq'>aide</a>
                                    <a href='/logout'>Déconnexion</a>
                                <div id='menu-close-button' class='red-bg small-radius' v-on:click='showHeaderMenu = false' style='width: 35px; height: 35px'></div>
            </div>
            <div id='header-menu-content'>
                                    <button onclick='window.open("/orders/gifts", "_self")' class='flex-row center-across space-around'><img width=25 height=25 src='/images/v2/header/giftsCTA_icon.svg'></img>Gifts</button>
                                <a href="/blog">Blogue</a>
                <a href="/marche">Marché</a>
                <a href="/about">À propos</a>
                <a href="#" onclick="klaro.show()">Politique de cookies</a>
                            </div>
        </div>
    </transition>
   
</div>
        <vue-popup ref='error-handler-popup' type='error'
            message="Une erreur sur la page est survenue! L'erreur a été logger pour IT. Si l'erreur persiste créer un ticket pour IT.">
        </vue-popup>
        <vue-popup ref='global-popup'
            v-bind='globalPopup'
        ></vue-popup>
        <div id='page-content' :class='{mobile: mobileMode}'>
            <div id="content">
		<script type="text/x-template" id='box_template'>
    <div class='box-wrapper' :class='{ "box-border" : border }'>
        <div class='header-image-container'>
            <img class='header-image' v-if='image' :src='image' />
        </div>
        <slot></slot>
    </div>
</script>

<script>
    // Initialize table-vue component
    Vue.component('box', {
        props: {
            'image': String,
            'border': Boolean,
        },
        data: function () {
            return {
            }
        },
        methods: {
            console: function(event) {
                console.log(event);
            }
        },
        template: "#box_template"
    })
</script>

<style>
    .box-wrapper {
        background:#FFF;
        position:relative;
        box-shadow: 0px 3px 6px #88888829;
        border-radius: 15px;
        margin-left:10px;
        margin-right:10px;
    }
    .box-wrapper .header-image-container {
        width:100%;
        max-height:180px;
        overflow:hidden;
    }
    .box-wrapper .header-image {
        width:100%;
        border-radius: 15px 15px 0px 0px;;
    } 
    .box-border {
        border-bottom: 20px solid #719500;
    }
</style><script type="text/x-template" id='tooltip_template'>
    <div>
        <div id='tooltip-container'
            ref='target'>
            <div class='tooltip'>
                {{ text }}
            </div>
        </div>
    </div>
</script>

<script>
    // Initialize table-vue component
    Vue.component('tooltip', {
        props: {
            'theme': String,
            'text': String,
        },
        data: function () {
            return {
                visible: false,
                windowSize: { width: window.innerWidth, height: window.innerHeight }
            }
        },
        mounted() {
            window.addEventListener('resize', this.handleResize)
        },
        beforeDestroy() {
            window.removeEventListener('resize', this.handleResize)
        },
        methods: {
            handleResize() {
                this.windowSize = { width: window.innerWidth, height: window.innerHeight }
            }
        },
        computed: {
            
        },
        template: "#tooltip_template"
    })
</script>

<style>
    #tooltip-container {
        width: 19px !important;
        height: 19px;
        background-image: url(/images/merchandiser/pap/infoBubble_inactive.svg) !important;
        background-repeat: no-repeat;
        margin: auto;
        background-size: 18px;
    }
    #tooltip-container .tooltip {
        display: none;
        position:absolute;
        /* bottom:4px; */
        background-color: #FFFFFF;
        color: #636363;
        font-family: gibsonlight;
        text-align: center;
        padding: 10px;
        border-radius: 4px;
        border: 1px solid #719500;
        font-size: 14px !important;
        pointer-events: none;
        top: -70px;
        left:50%;
        transform: translateX(-50%);
        white-space: normal;        
        min-width: 260px;
        width: 260px;
        z-index: 1000;
    }
    #tooltip-container:hover {
        background-image: url(/images/users/account-settings/Information_hover.svg) !important;
    }
    #tooltip-container:hover .tooltip {
        display: block;
    }
</style><script type="text/x-template" id='hover-template'>
    <div class='hoverover' v-on:click='locked = clickLockable ? !locked : false' v-on:mouseover='hovering = true' v-on:mouseleave='hovering = false'>
        <div ref='hover_box' v-if='hovering || locked' class='hover_box' v-bind:style='positionBox()'>
            {{text}}
            <slot></slot>
        </div>
    </div>
</script>
<div id='track-order-container' :class='{ error : error }'>
    <div id='track-order-top'>
        <div id='track-order-top-back'>
        ‹ <span @click='$root.windowOpen("/marche")'>Retourner sur le Marché</span>
        </div>
        <div id='track-order-top-title'>
            <img src='/images/notebox/truck.svg' />
            <div>Suivi de votre commande!</div>
        </div>
    </div>

    <box :border='false'>
        <template v-if='order_data && !loading && !error'>
            <div id='track-order-box-top'>
                <div class='order-info' :class='{ "hide-border" : order_data.step == 2 || order_data.canceled }'>
                    <div class='order-title'>
                        Commande  <span>#{{ order_data.order_id }}</span>
                    </div>
                    <div class='order-desc' v-html='order_data.desc' v-if='!order_data.canceled'></div>
                    <div class='order-cant-reach' v-if='order_data.cant_reach' v-html='order_data.cant_reach'></div>
                </div>
                <div class='reminder-info' v-if='order_data.step < 2'>
                    <div class='reminder-title'>
                        Rappel important                    </div>
                    <div class='reminder-desc' v-html='order_data.reminder'></div>
                </div>
            </div>
            <div v-if='order_data.late' class='late-container'>
                <div @click='order_data.step_id && cancelDelivery()' v-html='order_data.late'></div>
            </div>
            <div v-if='order_data.canceled' class='late-container'>
                <div v-html='order_data.cancel_content'></div>
            </div>
            <div id='track-order-box-pup-transfer' v-if='order_data.temporary_pup_transfer'>
                <span id='track-order-box-red-icon'>!</span>
                Votre point de cueillette a changé. Votre panier sera livré au point de cueillette <b>{{order_data.droppoint_name}} ( {{order_data.address}} )</b>. Nous sommes désolés pour l'inconvénient.            </div>
            <div id='track-order-box-middle' v-if='!order_data.canceled'>
                <div class='step-group step-completed'>
                    <div class='step-top'>placeholder</div>
                    <div class='step-middle'><img src='/images/notebox/step_complete.svg' /></div>
                    <div class='step-bottom'>
                        <span class='step-bottom-label'>
                            En préparation                        </span>
                    </div>
                </div>
                <div class='step-border step-border-first' :class='{ complete : order_data.step > 0 }'></div>
                <div class='step-group step-shipped' :class='{ "step-completed" : order_data.step > 0}'>
                    <div class='step-top'>placeholder</div>
                    <div class='step-middle' style='margin-bottom: 0px;margin-top:9px;'>
                        <img v-if='order_data.step > 0' src='/images/notebox/step_complete.svg' />
                        <span :class='{ "step-dot" : order_data.step == 0 }'></span>
                    </div>
                    <div class='step-bottom' style='margin: 0;'>
                        <span class='step-bottom-label'>
                            En route                            <tooltip style='margin-left:5px;' text='Votre commande a quitté notre centre de distribution.' />
                        </span>
                        <span class='basket-number'>{{ order_data.number_box_needed }} panier{{ order_data.number_box_needed > 1 ? 's' : '' }}</span>
                    </div>
                </div>
                <div class='step-border step-border-second' :class='{ complete : order_data.step > 1 }'></div>
                <div class='step-group' :class='{ "step-completed" : order_data.step > 1}'>
                    <div class='step-top step-delivered'>
                        <span v-if='order_data.stops_before_text' class='stops-before'>{{ order_data.stops_before_text }}</span>
                        <span class='step-top-label' v-if='order_data.step < 2'>
                            Heure d’arrivée estimée                            <tooltip style='margin-left:5px;' text='L’heure d’arrivée se mettra automatiquement à jour pour une estimation plus précis.'></tooltip>
                        </span>
                        <span class='step-top-label' style='color:#414042;top:-18px;' v-if='order_data.step == 2 && order_data.delivery_type == "PUP"'>
                            {{ order_data.pick_up_window }}
                        </span>
                        <span class='step-eta'>
                            {{ order_data.eta }}
                        </span>
                    </div>
                    <div class='step-middle' style='margin-top: 2px;'>
                        <img v-if='order_data.step > 1' src='/images/notebox/step_complete.svg' />
                        <span :class='{ "step-dot" : order_data.step < 2 }'></span>
                    </div>
                    <div class='step-bottom'>
                        <span class='step-bottom-label'>
                            <span class='flex-row'>Livré<span class='step-eta' v-if='order_data.step == 2'>{{ order_data.eta }}</span></span>
                            <span class='step-bottom-address'>
                                <span style='display:block;' v-if='order_data.delivery_type == "PUP"'>{{ order_data.droppoint_name }}</span>
                                <span style='display:block;'>{{ order_data.address }}</span>
                                <span class='step-bottom-address-eta step-bottom-mobile-target' v-if='order_data.step < 2'>
                                    Heure d’arrivée estimée                                    <tooltip style='margin-left:5px;' text='L’heure d’arrivée se mettra automatiquement à jour pour une estimation plus précis.'></tooltip>
                                    <span class='step-eta'>{{ order_data.eta }}</span>
                                </span>
                                <span v-if='order_data.stops_before_text' class='step-bottom-mobile-target stops-before'>{{ order_data.stops_before_text }}</span>
                                <span class='step-bottom-mobile-target step-bottom-pickup-window' v-if='order_data.step == 2 && order_data.delivery_type == "PUP"'>
                                    {{ order_data.pick_up_window }}
                                </span>
                            </span>
                        </span>
                    </div>
                </div>
            </div>
            <div id='track-order-box-bottom'>
                <div style='margin-right:150px;'>
                    <div>Commande livrée le :</div>
                    <div>{{ order_data.delivery_date }}</div>
                </div>
                <div class='track-order-amount-group'>
                    <div style='margin-right:25px;'>{{ order_data.order_amount_label }}
                        {{ order_data.order_amount }}
                    </div>
                    <a v-if='!order_data.canceled' class='view-invoice' href='/orders/view/id/24557262'>
                        Voir la facture                    </a>
                </div>
            </div>
        </template>
        <template v-else-if='loading'>
            <img class='loading-spinner' src='/images/merchandiser/circle_spinner.svg' />
        </template>
        <template v-else-if='error'>
            <div class='error-message'>{{ order_data && order_data.error ? order_data.error : "Une erreur est survenue. Veuillez réessayer plus tard." }}</div>
        </template>
    </box>
</div>

<script>
    vue_declare = {
        data: {
            order_id: 24557262,
            default_title: "Suivi de votre commande",
            order_data: null,
            loading: false,
            error: false,
        },
        methods: {
            getTrackOrderData: function() {
                if(!this.loading) {
                    let vue_obj = this;
                    this.loading = true;
                    $.ajax({
                        url: baseUrl + '/orders/getTrackOrderData',
                        type: 'POST',
                        dataType: 'json',                    
                        data: { order_id: vue_obj.order_id },
                        success: function (data) {
                            vue_obj.order_data = data;
                            vue_obj.loading = false;
                        },
                        error: function (data) {
                            vue_obj.error = true;
                            vue_obj.loading = false;
                        }
                    });
                }
            },
            cancelDelivery: function() {
                let vue_obj = this;
                this.$root.message({
                    type: 'yesno', 
                    popupTitle: "Voulez-vous vraiment annuler votre commande?",
                    popupConfirm: "Annuler",
                    popupReject: "Retour",
                    popupRejectClass: "back-button",
                    popupConfirmClass: "red-button",
                    confirmEvent: function() {
                        vue_obj.loading = true;
                        $.ajax({
                            type: "POST",
                            url: baseUrl + "/superMarket/CancelOngoingHomeDelivery",
                            dataType: "json",
                            data: {
                                step_id: vue_obj.order_data.step_id
                            },
                            success: function (result) {
                                if(result.success) {
                                    vue_obj.loading = false;
                                    vue_obj.getTrackOrderData();
                                } else {
                                    vue_obj.loading = false;
                                    vue_obj.error = true;
                                }
                            }, error: function(data) {
                                vue_obj.loading = false;
                                vue_obj.error = true;
                            }
                        });
                    }
                })
                
            },
        },
        mounted: function() {
            this.getTrackOrderData();
            let vue_obj = this;
            setInterval(function() {
                vue_obj.getTrackOrderData();
            }, 300000);
        }
    }
</script>

<style>
    #track-order-container {
        width: calc(100% - 20px);
        max-width: 1200px;
        margin:auto;
        margin-top:60px;
        margin-bottom:100px;
        padding-left:10px;
        padding-right: 10px;
    }
    #track-order-top {
        width:100%;
        margin-bottom:40px;
    }
    #track-order-box-top * {
        font-family:gibsonlight;
        font-size:17px;
        line-height: 22px;
    }
    #track-order-container #track-order-top-back {
        font-size:20px;
    }
    #track-order-container #track-order-top-back span {
        text-decoration: underline;
        font-size: 15px;
        font-family: gibsonlight;
        cursor: pointer;
    }
    #track-order-top-title {
        width:100%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: -33px;
    }
    #track-order-top-title img {
        margin-right:10px;
        height:30px;
    }
    #track-order-top-title div {
        font-size:22px;
        line-height: 50px;
        letter-spacing: 0px;
        color: #414042;
        opacity: 1;
    }
    #track-order-container .box-wrapper {
        border: 1px solid #719500;
    }
    #track-order-box-top, #track-order-box-bottom {
        padding: 30px 35px 30px 35px;
        display: flex;
    }
    #track-order-box-top {
        align-items: stretch;
    }
    #track-order-box-bottom  {
        align-items: center;
        padding-top:20px;
        padding-bottom:35px;
        flex-wrap: wrap;
    }
    #track-order-box-bottom > * {
        margin-top:15px;
    }
    .track-order-amount-group {
        display:flex;
        align-items: center;
    }
    #track-order-box-bottom a {
        color:#719520;
        text-decoration: none;
        border:1px solid #719500;
        font-size:17px;
        padding:6px 30px;
        border-radius: 4px;
        transition: all 0.5s;
    }
    #track-order-box-bottom a:hover {
        opacity:0.75;
    }
    #track-order-container .order-info div, #track-order-container .reminder-info div {
        margin-bottom:10px;
    }
    #track-order-container .reminder-info {
        margin-left:25px;
        width:30%;  
    }
    #track-order-container .order-info {
        width:70%;
        padding-right: 40px;
        border-right:1px solid #414042;
    }
    #track-order-container .reminder-title,
    #track-order-container .order-title, #track-order-container .order-title span {
        color:#414042;
        font-size:22px;
        font-family: gibsonregular;
    }
    #track-order-box-middle {
        padding: 50px 10px;        
        background-color: #F4F5EE;
        background: #F4F5EE;
    }
    #track-order-box-pup-transfer {
        padding: 20px 10px;        
        background-color: #D9665B26;
        background: #D9665B26;
        text-align: center;
        color:#C41200;
        font-size:17px;
    }
    #track-order-box-red-icon {
        background-color: #C41200;
        color: #F7F7F7;
        display: inline-block;
        height: 18px;
        width: 18px;
        margin-right:5px;
        text-align: center;
        border-radius: 50%;
        font-size: inherit;
    }
    #track-order-box-middle * {
        position:relative;
    }
    #track-order-container .loading-spinner {
        display:block;
        width: 30px;
        height: 30px;
        padding: 5px;
        margin:auto;
        margin-top:100px;
        margin-bottom:100px;
    }
    #track-order-container.error .box-wrapper {
        border-color: #b93123;
    }
    #track-order-container .error-message {
        display:block;
        width: 100%;
        text-align: center;
        font-size: 20px;
        font-family: gibsonregular;
        padding-top:100px;
        padding-bottom:100px;
        background-color: #b9312310;
        background: #b9312310;
        color:#b93123;
        text-align: center;
        border-radius: 15px;
    }
    #track-order-box-middle .step-border {
        border-bottom:3px dotted #719500;
        width:calc(100% - 225px);
        margin-left: -60px;
        margin-right: -60px;
    }
    #track-order-box-middle .step-border.complete {
        border-bottom:0px solid #719500;
        background: #719500;
        border-radius: 5px;
        height: 3px;
    }
    #track-order-box-middle .step-group {
        min-width: 170px;
        display:flex;
        flex-direction: column;
        align-items: center;
    }
    #track-order-box-middle .step-group div {
        margin-top:5px;
        margin-bottom:5px;
    }
    #track-order-box-middle .step-dot {
        width:9px;
        height:9px;
        border-radius: 5px;
        margin:8px;
        background-color: #719520;
        background: #719520;
        display: block;
    }
    #track-order-box-middle {
        display:flex;
        align-items: center;
        justify-content: space-between;
    }
    #track-order-box-middle .step-top:not(.step-delivered) {
        opacity: 0;
    }
    #track-order-box-middle .step-top .step-top-label {
        display: flex;
        align-items: center;
        position:absolute;
        top:-30px;
        font-size:12px;
        color:#41404275;
        font-family: gibsonregular;
        left: 50%;
        transform: translateX(-50%);
        white-space: nowrap;
    }
    .step-bottom-address-eta {
        display: flex;
        align-items: center;
        margin-top:-3px;
    }
    #track-order-box-middle .step-eta {
        font-family:gibsonmedium;
        color:#6E911F;
        font-size:15px;
    }
    #track-order-box-middle .step-bottom {
        margin-top:10px;
    }
    #track-order-box-middle .step-bottom-label {
        color:#909090;
        font-size:15px;
        line-height: 17px;
        font-family: gibsonregular;
        display: flex;
        align-items: center;
    }
    #track-order-box-middle .step-bottom-label .step-eta {
        display:none;
    }
    #track-order-box-middle .step-completed .step-bottom-label {
        color:#414042;
    }
    #track-order-box-middle .step-bottom-address, #track-order-box-middle .basket-number {
        color:#909090 !important;
        font-size:12px;
        position:absolute;
        top: 21px;
        width: 180px;
        text-align: center;
        left:50%;
        transform: translateX(-50%);
        font-family: gibsonregular;
    }
    #track-order-box-middle .basket-number {
        top: 32px;
        color: #909090;
    }
    .order-cant-reach a {
        font-family: gibsonlight;
    }
    .step-bottom-mobile-target {
        display: none;
    }
    #track-order-container .order-info.hide-border {
        border-right:none;
        padding-right:0px;
    }
    #track-order-container .order-info.hide-border .order-cant-reach {
        margin-bottom:0px;
    }
    #track-order-container .late-container * {
        font-size:17px;
    }
    #track-order-container .late-container {
        text-align: center;
        padding: 10px;
        padding-left:20px;
        padding-right:20px;
        background: #D9665B26;
        background-color: #D9665B26;
        color: #C41200;
    }
    #track-order-container .late-container div {
        display: block;
        /* max-width: 650px; */
        margin:auto;
    }
    #track-order-container .late-container div img {
        margin-right:8px;
    }
    #track-order-container .late-container a {
        color:#C41200;
        font-family: gibsonlight;
        font-size:17px;
    }
    .red-button {
        background-color:#C41200 !important;
    }
    .back-button {
        background-color:#A6B2B9 !important;
    }
    .popup-component h2 {
        margin-bottom:50px !important;
    }
    .popup-component button:hover {
        opacity:0.8 !important;
    }
    #track-order-container .stops-before {
        font-size: 12px;
        position:absolute;
        bottom:41px;
        left:50%;
        transform: translateX(-50%);
        color: #909090;
        white-space: nowrap;
    }
    /* under 750px media query */
    @media (max-width: 1000px) {
        #track-order-container {
            margin-top: 30px;
        }
    }
    @media (max-width: 750px) {
        .box-wrapper {
            margin-left:0px;
            margin-right:0px;
        }
        #track-order-top {
            margin-bottom:25px;
        }
        #track-order-top-title {
            margin-top: 30px;
        }
        #track-order-container .order-info {
            width:100%;
            border-right:none;
            border-bottom:1px solid #414042;
            padding-right:0px;
            padding-bottom:10px;
        }
        #track-order-container .reminder-info {
            width:100%;
            margin-left:0;
            margin-top:15px;
        }
        #track-order-box-top {
            padding: 30px 20px 20px 20px;
            display:block;
        }
        #track-order-box-bottom {
            padding: 15px 20px 30px 20px;
        }
        #track-order-box-middle {
            align-items: normal;
            flex-direction: column;
            padding: 70px 30px;
            padding-right: 5px;
            padding-top: 15px;
        }
        #track-order-box-middle .step-group {
            flex-direction: row;
        }
        #track-order-box-middle .step-top {
            display: none;
        }
        #track-order-box-middle .step-group div {
            margin-top:5px !important;
            margin-bottom: 5px !important;
        }
        #track-order-box-middle .step-border {
            border-bottom:none;
            border-left:3px dotted #719500;
            width:100%;
            margin:0px;
            height: 80px;
            margin-left: 11px;
            /* margin-top: -5px; */
            /* margin-bottom: -5px; */
        }
        #track-order-box-middle .step-middle {
            margin-right:9px;
            height:25px;
        }
        #track-order-box-middle .step-border.complete {
            border-bottom:none;
            border-left:0px solid #719500;
            width:100%;
            background: #719500;
            border-radius: 5px;
            width: 3px;
            height:80px;
        }
        #track-order-box-middle .step-border-first {
            margin-bottom:-5px;
            margin-top:0px;
        }
        #track-order-box-middle .step-border-second {
            margin-top:-5px;
            margin-bottom:0px;
        }
        #track-order-box-middle .step-group div.step-bottom {
            margin-top:0px !important;
        }
        #track-order-box-middle .step-bottom, #track-order-box-middle .step-bottom-label {
            width: 100%;
        }
        #track-order-box-middle .step-bottom-address, #track-order-box-middle .basket-number {
            left: 0px;
            text-align: left;
            width:100%;
            transform: none;
        }
        .step-bottom-mobile-target {
            display: flex;
        }
        #track-order-box-middle .step-bottom-label .step-eta {
            display:block;
            margin-left:5px;
        }
        #track-order-container .order-info.hide-border {
            border-bottom: 0px;
            padding-bottom:0px;
        }
        .step-bottom-pickup-window {
            color:#414042;
            margin-top:8px;
        }
        #track-order-container .reminder-info div.reminder-desc {
            margin-bottom: 0px;
        }
        #track-order-container .stops-before {
            bottom:-6px;
            left:0;
            transform:none;
        }
    }
    @media (max-width: 420px) {
        #track-order-box-bottom {
            display: block;
        }
        #track-order-box-pup-transfer {
            text-align: left;
        }
        #track-order-box-bottom > * {
            margin-right:0px !important;
        }
        #track-order-box-bottom a {
            margin-left:0px;
            display: block;
            margin-top: 15px;
            text-align: center;
        }
        .track-order-amount-group {
            display:block;
        }
    }
</style>		<div class="clear"></div>
</div><!-- content -->
            
                    </div>
        <div id='footer'>
    <div id='footer-content'>
        <div id='about-us'>
            <div class='title'>À propos</div>
            <!-- <a href="/aide">Contactez-nous</a> -->
            <a href="/activites-communautaires#">Visiter notre ferme</a>
            <a href="/press">Salle de presse</a>
            <a href="/security">Sécurité</a>
            <a href="#" onclick="klaro.show()">Politique de cookies</a>
        </div>
        <div id='get-involved'>
            <div class='title'>Engagez-vous</div>
            <a href="/fr/">Nos partenaires</a>
            <a href="/aide/reponses/80">Devenir PDC</a>
            <a href="/careers">Carrières</a>
        </div>
        <div id='share'>
            <div class='title'>Partagez</div>
                            <a href="/account#invite">Inviter un ami</a>
             
            <a target="_blank" href="https://www.facebook.com/lesfermeslufa">Facebook</a>
            <a target="_blank" href="http://www.instagram.com/lufafarms">Instagram</a>
        </div>
        <div id='newsletter'>
            <div class='title'>Soyez dans le coup!</div>
            <div class='footer-text'>Inscrivez-vous pour ne rien manquer avec notre infolettre.</div>
            <div class='flex-row flex-wrap'>
                <v-input class='mar-top-10' v-model='newsletter_email' style='margin:0px;margin-right:10px;max-width:calc(100% - 90px) !important;' type="text" id="news_email" name="news_email" placeholder='Inscrivez votre courriel'></v-input>
                <button class='mar-top-10' style='width: 70px !important;min-width: auto;' :class='{ disabled : !$root.isEmailValid(newsletter_email) }' @click='subscribeNewsletter'>Ok</button>
            </div>
        </div>
    </div>
    <div id='copyright'>
        2025 © Les Fermes Lufa inc. - <a href="/termes">Termes et conditions</a> - <a href="/politique-confidentialite">Politique de confidentialité</a>    </div>
</div>    </div>
    <script type="text/x-template" id='not-found-template'>   
    <div class='not-found'>
        <div class='box'>
            <h1>Oups!</h1>
            <p>Cette page n’existe pas, vous êtes dans les patates! Retournez à la <a href="/site">page d'accueil</a> ou <a href="/aide"> communiquez avec nous</a> si vous avez de la difficulté à trouver ce que vous cherchez.</p>
            <a @click='redirect_url ? $root.windowOpen(redirect_url) : $router.go(-1)'>Go back</a>
            <div class="error-image"></div>
        </div>
    </div>
</script>    <script type="text/x-template" id='no-access-template'>   
    <div class='not-found'>
        <div class='box'>
            <h1>Oups!</h1>
            <p>Cette page n’existe pas, vous êtes dans les patates! Retournez à la <a href="/site">page d'accueil</a> ou <a href="/aide"> communiquez avec nous</a> si vous avez de la difficulté à trouver ce que vous cherchez.</p>
            <a @click='redirect_url ? $root.windowOpen(redirect_url) : $router.go(-1)'>Go back</a>
            <div class="error-image"></div>
        </div>
    </div>
</script>
<!-- Global Help-Chat component mount (client theme) -->
    <div id="global-help-chat-app" style="display:none;">
        <help-chat
            v-if="showChat && isChatEnabledApi && isLoggedIn"
            :user-id="currentUserId"
            :user-name="String('Maxime')"
            @close="closeChat"
            @chat-error="handleChatError">
        </help-chat>

        <a href="#" @click.prevent="openChat"
           v-if="isChatEnabledApi && !showChat && isLoggedIn"
           class="chat-global-trigger-button superlufa-profile-help-widget"
           :class="{ 'fr': lang === 'fr' }">
            <img src="/images/users/account-settings/help-icon.svg" alt="Besoin d'aide?">
            Besoin d'aide?        </a>
    </div>

        <script type="text/javascript">
        (function() {
            if (window.hasGlobalHelpChat) return;
            console.log('[HelpChat] Initialising global chat …');

            async function fetchChatStatus() {
                try {
                    const response = await fetch('/chat/isHelpChatEnabled');
                    if (!response.ok) {
                        console.error('[HelpChat] API request failed:', response.status);
                        return false;
                    }
                    const data = await response.json();
                    if (data.success && data.data) {
                        return data.data.is_enabled;
                    }
                    console.error('[HelpChat] API response error:', data);
                    return false;
                } catch (error) {
                    console.error('[HelpChat] Error fetching chat status:', error);
                    return false;
                }
            }

            function initHelpChat(isChatEnabledFromApi) {
                if (typeof Vue === 'undefined') {
                    console.log('[HelpChat] Vue not yet available, waiting…');
                    return false;
                }

                var vm = new Vue({
                    el: '#global-help-chat-app',
                    data: {
                        showChat: false,
                        isChatEnabledApi: isChatEnabledFromApi, // Store API result
                        lang: 'fr', // Directly use PHP $language
                        isLoggedIn: !!localStorage.getItem('helpchat_user_id'),
                        currentUserId: localStorage.getItem('helpchat_user_id') || '',
                    },
                    methods: {
                        openChat() { if (this.isChatEnabledApi && this.isLoggedIn) this.showChat = true; },
                        closeChat() { this.showChat = false; },
                        handleChatError() {
                            console.error('[HelpChat] A critical error occurred in the chat component. Hiding chat.');
                            this.isChatEnabledApi = false; // This will hide the chat and button
                            this.showChat = false;
                        }
                    },
                    async mounted() {
                        console.log('[HelpChat] Vue instance mounted');
                        if (this.isChatEnabledApi && this.isLoggedIn) {
                           this.$el.style.display = ''; // Show container only if API said enabled
                        } else {
                           console.log('[HelpChat] Chat is disabled via API or user logged out. Not showing.');
                        }

                        // Listen for login/logout in other tabs
                        window.addEventListener('storage', (evt) => {
                            if (evt.key === 'helpchat_user_id') {
                                this.isLoggedIn = !!evt.newValue;
                                this.currentUserId = evt.newValue || '';
                                if (!this.isLoggedIn) {
                                    this.showChat = false;
                                }
                            }
                        });
                    }
                });

                // Expose a safe global helper to open the chat from anywhere (e.g. FAQ page)
                try {
                    window.globalHelpChatVm = vm;
                    window.tryOpenGlobalHelpChat = function(fallbackUrl) {
                        try {
                            if (vm && typeof vm.openChat === 'function' && vm.isChatEnabledApi && vm.isLoggedIn) {
                                vm.openChat();
                                return true;
                            }
                        } catch (e) { /* noop */ }
                        if (fallbackUrl) {
                            try { window.location.href = fallbackUrl; } catch (e2) { /* noop */ }
                        }
                        return false;
                    };

                    // Attention animation: pulse waves then brief expand, then open
                    window.pulseGlobalHelpChat = function(opts) {
                        var options = opts || {};
                        var thenOpen = !!options.thenOpen;
                        var pulseMs = typeof options.delayMs === 'number' ? options.delayMs : 1000;
                        var expandMs = typeof options.expandMs === 'number' ? options.expandMs : 250;

                        try {
                            var trigger = document.querySelector('.chat-global-trigger-button') || document.querySelector('.chat-trigger-button');
                            if (trigger && vm && !vm.showChat) {
                                try { trigger.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' }); } catch (e3) { /* noop */ }
                                trigger.classList.add('highlight-pulse');
                                setTimeout(function() {
                                    trigger.classList.remove('highlight-pulse');
                                    trigger.classList.add('highlight-expand');
                                    setTimeout(function() {
                                        trigger.classList.remove('highlight-expand');
                                        if (thenOpen && typeof vm.openChat === 'function' && vm.isChatEnabledApi && vm.isLoggedIn) {
                                            vm.openChat();
                                        }
                                    }, expandMs);
                                }, pulseMs);
                                return true;
                            }

                            var container = document.querySelector('.help-chat-container');
                            if (container) {
                                container.classList.add('highlight-pulse');
                                setTimeout(function() { container.classList.remove('highlight-pulse'); }, pulseMs);
                                return true;
                            }
                        } catch (e) { /* noop */ }
                        return false;
                    };
                } catch (e) { /* noop */ }

                window.hasGlobalHelpChat = true;
                console.log('[HelpChat] Global chat ready');
                return true;
            }

            async function main() {
                const isChatEnabled = await fetchChatStatus();
                if (!isChatEnabled) {
                    console.log('[HelpChat] Chat explicitly disabled by API or API error. Chat will not be loaded.');
                    // Optionally hide the #global-help-chat-app container or prevent Vue init
                    const chatContainer = document.getElementById('global-help-chat-app');
                    if (chatContainer) chatContainer.style.display = 'none';
                    return;
                }

                if (initHelpChat(isChatEnabled)) return;

                var attempts = 0;
                var interval = setInterval(function() {
                    attempts++;
                    if (initHelpChat(isChatEnabled) || attempts > 25) {
                        clearInterval(interval);
                        if (attempts > 25) {
                            console.error('[HelpChat] Vue never loaded – chat disabled');
                        }
                    }
                }, 200);
            }

            main(); // Call the main async function

        })();
        </script>
</body>

</html>

<script>
    translations['no_access'] =
        "Pas d'accès";
    translations['not_found'] =
        "Page Non Trouvée";
    permissions = {"default_member":"default_member","default_guest":"default_guest","About.SendHRCareerMessage":"About.SendHRCareerMessage","AgentStats.*":"AgentStats.*","Blog.GetBlogs":"Blog.GetBlogs","Blog.GetBlogUrl":"Blog.GetBlogUrl","Blog.Index":"Blog.Index","Blog.Rating":"Blog.Rating","Blog.View":"Blog.View","Charitable.DirectGiveback":"Charitable.DirectGiveback","Charitable.GenerateGivebackTransactionData":"Charitable.GenerateGivebackTransactionData","CommunityEvents.Client":"CommunityEvents.Client","CommunityEvents.ClientAddToWaitlist":"CommunityEvents.ClientAddToWaitlist","CommunityEvents.ClientGetEvent":"CommunityEvents.ClientGetEvent","CommunityEvents.ClientGetEvents":"CommunityEvents.ClientGetEvents","CommunityEvents.ClientGetScheduledEvent":"CommunityEvents.ClientGetScheduledEvent","CommunityEvents.ClientGetScheduledEventsByUser":"CommunityEvents.ClientGetScheduledEventsByUser","CommunityEvents.ClientGuestSave":"CommunityEvents.ClientGuestSave","CommunityEvents.ClientReschedule":"CommunityEvents.ClientReschedule","CommunityEvents.ClientSendInstitutionRequest":"CommunityEvents.ClientSendInstitutionRequest","CommunityEvents.ClientValidateDedicatedUrlPage":"CommunityEvents.ClientValidateDedicatedUrlPage","CommunityEvents.FindAvailableEventTimes":"CommunityEvents.FindAvailableEventTimes","CommunityEvents.ReserveEvent":"CommunityEvents.ReserveEvent","CommunityEvents.SendEventConfirmationEmail":"CommunityEvents.SendEventConfirmationEmail","CommunityRest.StartAgentSession":"CommunityRest.StartAgentSession","CommunityRest.StopAgentSession":"CommunityRest.StopAgentSession","Coupons.GiftCoupons":"Coupons.GiftCoupons","Coupons.PrintCoupon":"Coupons.PrintCoupon","Coupons.ReclaimCoupon":"Coupons.ReclaimCoupon","Cs.AjaxGetStatus":"Cs.AjaxGetStatus","Cs.CreateTicket":"Cs.CreateTicket","Cs.CreateTicketPost":"Cs.CreateTicketPost","Cs.Feedback":"Cs.Feedback","Cs.HdAvailabilityVerification":"Cs.HdAvailabilityVerification","Cs.MarkWaiting":"Cs.MarkWaiting","Cs.SubmitFeedbackAjax":"Cs.SubmitFeedbackAjax","Department.GetUserBadge":"Department.GetUserBadge","Droppoints.PrivatePupMarkers":"Droppoints.PrivatePupMarkers","Droppoints.View":"Droppoints.View","EmailStats.Audit":"EmailStats.Audit","EmailStats.AuditData":"EmailStats.AuditData","EmailStats.Bounced":"EmailStats.Bounced","EmailStats.Track":"EmailStats.Track","Gift.Index":"Gift.Index","Gift.Thankyou":"Gift.Thankyou","InteractiveQuestionsAnswers.Form":"InteractiveQuestionsAnswers.Form","InteractiveQuestionsAnswers.GetCommunityHtml":"InteractiveQuestionsAnswers.GetCommunityHtml","InteractiveQuestionsAnswers.GetForm":"InteractiveQuestionsAnswers.GetForm","InteractiveQuestionsAnswers.RequestRefund":"InteractiveQuestionsAnswers.RequestRefund","MealPlanner.actionClearGenerationFlag":"MealPlanner.actionClearGenerationFlag","MealPlanner.actionGetMPUsersNonMPAvg":"MealPlanner.actionGetMPUsersNonMPAvg","MealPlanner.actionSetGenerationFlag":"MealPlanner.actionSetGenerationFlag","MealPlanner.AddAllIngredientsToOrder":"MealPlanner.AddAllIngredientsToOrder","MealPlanner.AddRecipeIngredientsToOrder":"MealPlanner.AddRecipeIngredientsToOrder","MealPlanner.AddSyntheticMeal":"MealPlanner.AddSyntheticMeal","MealPlanner.AddToCart":"MealPlanner.AddToCart","MealPlanner.DeleteMeal":"MealPlanner.DeleteMeal","MealPlanner.DeleteMember":"MealPlanner.DeleteMember","MealPlanner.DownloadMealPlan":"MealPlanner.DownloadMealPlan","MealPlanner.DownloadRecipe":"MealPlanner.DownloadRecipe","MealPlanner.DuplicateRecipe":"MealPlanner.DuplicateRecipe","MealPlanner.FetchAiKitchenRecipes":"MealPlanner.FetchAiKitchenRecipes","MealPlanner.FindSimilarRecipes":"MealPlanner.FindSimilarRecipes","MealPlanner.GenerateFullRecipes":"MealPlanner.GenerateFullRecipes","MealPlanner.GeneratePreferenceMeals":"MealPlanner.GeneratePreferenceMeals","MealPlanner.GenerateRecipe":"MealPlanner.GenerateRecipe","MealPlanner.GenerateRecipeImages":"MealPlanner.GenerateRecipeImages","MealPlanner.GenerateRecipeNames":"MealPlanner.GenerateRecipeNames","MealPlanner.GetBudgetTotal":"MealPlanner.GetBudgetTotal","MealPlanner.GetFeedback":"MealPlanner.GetFeedback","MealPlanner.GetGeneratedImageUrls":"MealPlanner.GetGeneratedImageUrls","MealPlanner.GetIngredients":"MealPlanner.GetIngredients","MealPlanner.GetInstructions":"MealPlanner.GetInstructions","MealPlanner.GetKPIData":"MealPlanner.GetKPIData","MealPlanner.GetKPIOrderDetails":"MealPlanner.GetKPIOrderDetails","MealPlanner.GetKPISummary":"MealPlanner.GetKPISummary","MealPlanner.GetMealPlanDetails":"MealPlanner.GetMealPlanDetails","MealPlanner.GetMeals":"MealPlanner.GetMeals","MealPlanner.GetMembers":"MealPlanner.GetMembers","MealPlanner.GetMPUsersNonMPAvg":"MealPlanner.GetMPUsersNonMPAvg","MealPlanner.GetNutritionDetails":"MealPlanner.GetNutritionDetails","MealPlanner.GetOrderedMeals":"MealPlanner.GetOrderedMeals","MealPlanner.GetRecipeGeneratorData":"MealPlanner.GetRecipeGeneratorData","MealPlanner.GetUserPreferences":"MealPlanner.GetUserPreferences","MealPlanner.ManageFeedback":"MealPlanner.ManageFeedback","MealPlanner.RateAiKitchenRecipe":"MealPlanner.RateAiKitchenRecipe","MealPlanner.RecipeGenerator":"MealPlanner.RecipeGenerator","MealPlanner.RegenerateRecipe":"MealPlanner.RegenerateRecipe","MealPlanner.RegenerateRecipeName":"MealPlanner.RegenerateRecipeName","MealPlanner.RemoveAiKitchenRecipe":"MealPlanner.RemoveAiKitchenRecipe","MealPlanner.RemoveFromCart":"MealPlanner.RemoveFromCart","MealPlanner.RemoveRecipe":"MealPlanner.RemoveRecipe","MealPlanner.ReviewPlans":"MealPlanner.ReviewPlans","MealPlanner.SaveFeedback":"MealPlanner.SaveFeedback","MealPlanner.SaveMeal":"MealPlanner.SaveMeal","MealPlanner.SaveMember":"MealPlanner.SaveMember","MealPlanner.SaveUserPreferences":"MealPlanner.SaveUserPreferences","MealPlanner.Settings":"MealPlanner.Settings","MealPlanner.SubmitFeedback":"MealPlanner.SubmitFeedback","MealPlanner.ToggleDetailedMode":"MealPlanner.ToggleDetailedMode","MealPlanner.ToggleMoneySaver":"MealPlanner.ToggleMoneySaver","MealPlanner.UpdateSyntheticMeal":"MealPlanner.UpdateSyntheticMeal","MealPlanner.ViewFeedback":"MealPlanner.ViewFeedback","NotificationMessages.UpdateSessionClicks":"NotificationMessages.UpdateSessionClicks","NotificationMessages.UpdateUniqueClicks":"NotificationMessages.UpdateUniqueClicks","Orders.ActivateOrder":"Orders.ActivateOrder","Orders.CancelAll":"Orders.CancelAll","Orders.CancelOrder":"Orders.CancelOrder","Orders.ConfirmAlcoholToc":"Orders.ConfirmAlcoholToc","Orders.CreateGiftBasket":"Orders.CreateGiftBasket","Orders.CreateSecondHarvest":"Orders.CreateSecondHarvest","Orders.CustomizeGiftBasket":"Orders.CustomizeGiftBasket","Orders.Download":"Orders.Download","Orders.GetBasketContentGiftPage":"Orders.GetBasketContentGiftPage","Orders.GetOrderDeliveryDate":"Orders.GetOrderDeliveryDate","Orders.GetTrackOrderData":"Orders.GetTrackOrderData","Orders.Gifts":"Orders.Gifts","Orders.Ondemand":"Orders.Ondemand","Orders.RequestTrial":"Orders.RequestTrial","Orders.SecondHarvestDroppoints":"Orders.SecondHarvestDroppoints","Orders.TrackOrder":"Orders.TrackOrder","Orders.View":"Orders.View","Orders.ViewOrder":"Orders.ViewOrder","Page.View":"Page.View","Products.GetNutrionalFactsForPopUp":"Products.GetNutrionalFactsForPopUp","RAndDLog.SaveLog":"RAndDLog.SaveLog","Ratings.AcknowledgeGooglePrompt":"Ratings.AcknowledgeGooglePrompt","Ratings.SubmitRating":"Ratings.SubmitRating","Ratings.UserOrderRating":"Ratings.UserOrderRating","Recipe.View":"Recipe.View","Root.Login":"Root.Login","Root.ValidateLocation":"Root.ValidateLocation","Signup.GetUserHomeAddress":"Signup.GetUserHomeAddress","Signup.SignupDroppoints":"Signup.SignupDroppoints","Site.LogVueError":"Site.LogVueError","Site.NewsletterLanding":"Site.NewsletterLanding","Site.SetReturnUrl":"Site.SetReturnUrl","Subscriptions.GetHdTimeSlots":"Subscriptions.GetHdTimeSlots","Subscriptions.HdAvailabilityVerification":"Subscriptions.HdAvailabilityVerification","Subscriptions.TypeSwitchCheck":"Subscriptions.TypeSwitchCheck","Subscriptions.UserTypeSwitch":"Subscriptions.UserTypeSwitch","SuperMarket.GetAllGiftProducts":"SuperMarket.GetAllGiftProducts","SuperMarket.GetCloseDgCheckout":"SuperMarket.GetCloseDgCheckout","SuperMarket.GetNoteboxData":"SuperMarket.GetNoteboxData","SuperMarket.GetProductWithDate":"SuperMarket.GetProductWithDate","Suppliers.ActivateAccount":"Suppliers.ActivateAccount","Survey.GetQuestions":"Survey.GetQuestions","Survey.GetTranslations":"Survey.GetTranslations","Survey.PetFoodSurvey":"Survey.PetFoodSurvey","Survey.SaveResponses":"Survey.SaveResponses","Survey.YearlySurvey":"Survey.YearlySurvey","Task.Login":"Task.Login","Transactions.Download":"Transactions.Download","Transactions.View":"Transactions.View","Users.ActivateAccount":"Users.ActivateAccount","Users.ActivationReminderEmailUpdate":"Users.ActivationReminderEmailUpdate","Users.ActivationReminderSmsUpdateAjax":"Users.ActivationReminderSmsUpdateAjax","Users.AddCard":"Users.AddCard","Users.AddCommunicationsUser":"Users.AddCommunicationsUser","Users.AddCouponCode":"Users.AddCouponCode","Users.Adddeposit":"Users.Adddeposit","Users.AddVacation":"Users.AddVacation","Users.AgentByExtension":"Users.AgentByExtension","Users.AnonymousCommsUpdate":"Users.AnonymousCommsUpdate","Users.BillingData":"Users.BillingData","Users.Cancelation":"Users.Cancelation","Users.CancelationActionLog":"Users.CancelationActionLog","Users.CancelationLogs":"Users.CancelationLogs","Users.CancelationUserNotes":"Users.CancelationUserNotes","Users.CancelOrder":"Users.CancelOrder","Users.CancelReservation":"Users.CancelReservation","Users.CancelSubscription":"Users.CancelSubscription","Users.CancelVacation":"Users.CancelVacation","Users.ChangeAnonymitySetting":"Users.ChangeAnonymitySetting","Users.ChangeCardsPriority":"Users.ChangeCardsPriority","Users.ChangeDefaultDelivery":"Users.ChangeDefaultDelivery","Users.ChangeOrderLocation":"Users.ChangeOrderLocation","Users.ChargeCardPreFlow":"Users.ChargeCardPreFlow","Users.CommunicationLanguageUpdateAjax":"Users.CommunicationLanguageUpdateAjax","Users.ConfirmNewsletterEmail":"Users.ConfirmNewsletterEmail","Users.CustomizationReminderEmailUpdate":"Users.CustomizationReminderEmailUpdate","Users.CustomizationReminderSmsUpdateAjax":"Users.CustomizationReminderSmsUpdateAjax","Users.DeleteCard":"Users.DeleteCard","Users.DeliveryData":"Users.DeliveryData","Users.DeliveryPreferencesUpdateAjax":"Users.DeliveryPreferencesUpdateAjax","Users.DisableUserCommsAjax":"Users.DisableUserCommsAjax","Users.DisableUserPaymentsAjax":"Users.DisableUserPaymentsAjax","Users.DownloadTaxReceipts":"Users.DownloadTaxReceipts","Users.EventsData":"Users.EventsData","Users.FinalNotificationSettings":"Users.FinalNotificationSettings","Users.FoodPreferencesUpdateAjax":"Users.FoodPreferencesUpdateAjax","Users.GetCancelSubscriptionQuestions":"Users.GetCancelSubscriptionQuestions","Users.GetCancelSubscriptionTranslations":"Users.GetCancelSubscriptionTranslations","Users.GetGlobalUserDonationData":"Users.GetGlobalUserDonationData","Users.GetInvitationInfoAjax":"Users.GetInvitationInfoAjax","Users.GetNextBasketAfterPause":"Users.GetNextBasketAfterPause","Users.GetPaymentUrlAjax":"Users.GetPaymentUrlAjax","Users.GetRealexHPP":"Users.GetRealexHPP","Users.GetTransactionsAndOrdersAjax":"Users.GetTransactionsAndOrdersAjax","Users.GetUnreturnedBoxesAjax":"Users.GetUnreturnedBoxesAjax","Users.GetUserCommsAjax":"Users.GetUserCommsAjax","Users.GetUserPaymentsAjax":"Users.GetUserPaymentsAjax","Users.GetVacationIntervalAndNextBaskets":"Users.GetVacationIntervalAndNextBaskets","Users.GiftsData":"Users.GiftsData","Users.hasValidCreditCard":"Users.hasValidCreditCard","Users.HelpData":"Users.HelpData","Users.HideWalkthrough":"Users.HideWalkthrough","Users.IncentiveData":"Users.IncentiveData","Users.InviteData":"Users.InviteData","Users.Lostpassword":"Users.Lostpassword","Users.MarketplaceOpenEmailUpdateAjax":"Users.MarketplaceOpenEmailUpdateAjax","Users.MarketplaceOpenSmsUpdateAjax":"Users.MarketplaceOpenSmsUpdateAjax","Users.Newsletter":"Users.Newsletter","Users.NewsletterSignUp":"Users.NewsletterSignUp","Users.NoteboxData":"Users.NoteboxData","Users.NotificationData":"Users.NotificationData","Users.OneTimeDonation":"Users.OneTimeDonation","Users.OneTimeGivebackDonation":"Users.OneTimeGivebackDonation","Users.OrdersData":"Users.OrdersData","Users.PasswordUpdateAjax":"Users.PasswordUpdateAjax","Users.ProfileData":"Users.ProfileData","Users.ProfileUpdateAjax":"Users.ProfileUpdateAjax","Users.ProgramData":"Users.ProgramData","Users.ReactivateOrder":"Users.ReactivateOrder","Users.ReceiveMonthlyEmailUpdateAjax":"Users.ReceiveMonthlyEmailUpdateAjax","Users.RecipesData":"Users.RecipesData","Users.RemoveCoholder":"Users.RemoveCoholder","Users.RemoveCouponCode":"Users.RemoveCouponCode","Users.Reswitch":"Users.Reswitch","Users.SendCommunityCoordinatorMessage":"Users.SendCommunityCoordinatorMessage","Users.SendInvitationsAjax":"Users.SendInvitationsAjax","Users.SendInvite":"Users.SendInvite","Users.SendRepMessage":"Users.SendRepMessage","Users.SendUnreturnedBasketTicket":"Users.SendUnreturnedBasketTicket","Users.SendValidationCode":"Users.SendValidationCode","Users.SetGivebackDonation":"Users.SetGivebackDonation","Users.SettingsData":"Users.SettingsData","Users.SetWeeklyDonation":"Users.SetWeeklyDonation","Users.SmsAtDeliveryUpdateAjax":"Users.SmsAtDeliveryUpdateAjax","Users.SubmitCancelationFeedback":"Users.SubmitCancelationFeedback","Users.SubmitDGFeedback":"Users.SubmitDGFeedback","Users.SubscriptionData":"Users.SubscriptionData","Users.SubstitutionPreferencesUpdateAjax":"Users.SubstitutionPreferencesUpdateAjax","Users.TaxReceiptsLanding":"Users.TaxReceiptsLanding","Users.Unsubscribe":"Users.Unsubscribe","Users.UpdateCoholderSettings":"Users.UpdateCoholderSettings","Users.UpdateCouponAjax":"Users.UpdateCouponAjax","Users.UpdateFoodPreference":"Users.UpdateFoodPreference","Users.UpdateLangPreference":"Users.UpdateLangPreference","Users.UpdateNotifications":"Users.UpdateNotifications","Users.UpdatePassword":"Users.UpdatePassword","Users.UpdatePopulationMethod":"Users.UpdatePopulationMethod","Users.UpdateUser":"Users.UpdateUser","Users.UpdateUserSettings":"Users.UpdateUserSettings","Users.UserByEmail":"Users.UserByEmail","Users.UserByNumber":"Users.UserByNumber","Users.UserPaymentsPrioritiesAjax":"Users.UserPaymentsPrioritiesAjax","Users.UserSettings":"Users.UserSettings","Users.ValidatePhone":"Users.ValidatePhone","Vacations.AddDeliverySuspensionAjax":"Vacations.AddDeliverySuspensionAjax","Vacations.DisableDeliverySuspensionAjax":"Vacations.DisableDeliverySuspensionAjax","Vacations.GetDeliverySuspensionsAjax":"Vacations.GetDeliverySuspensionsAjax","Vacations.GetDeliverySuspsensionsAjax":"Vacations.GetDeliverySuspsensionsAjax","WorkWave.Callback":"WorkWave.Callback"} ;

    $(document).ready(() => {
        $('#page-wrapper script').appendTo('body');
        $('#page-wrapper style').appendTo('body');
        applyVueGlobal();
        setupKlaro();
    });
</script>